<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Health Risk/Protection Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f7f9fc; }
        .card-container { perspective: 1000px; height: 12rem; }
        .flip-card { 
            width: 100%; height: 100%; transition: transform 0.6s; 
            transform-style: preserve-3d; cursor: pointer;
        }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; }
        .flipped .flip-card-inner { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 0.75rem; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); padding: 1rem; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .card-front { z-index: 2; transform: rotateY(0deg); }
        .card-back { transform: rotateY(180deg); background-color: #ffffff; }
        .risk { background-color: #fee2e2; border: 2px solid #ef4444; color: #991b1b; }
        .protective { background-color: #d1fae5; border: 2px solid #10b981; color: #065f46; }
        .insignificant { background-color: #eff6ff; border: 2px solid #3b82f6; color: #1e40af; }
        .icon { font-size: 2rem; }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-800 mb-2 text-center">Mental Health Risk/Protection Explorer</h1>
        <p class="text-gray-600 text-center mb-8">Click on a factor to reveal the statistical proof (aOR, CI, p-value).</p>

        <!-- Tab Navigation -->
        <div class="flex flex-wrap justify-center space-x-2 sm:space-x-4 mb-8 border-b border-gray-300">
            <button class="tab-button py-2 px-4 rounded-t-lg font-semibold text-sm transition duration-150 active-tab" 
                    data-category="Socio-Demographic">Socio-Demographic Factors</button>
            <button class="tab-button py-2 px-4 rounded-t-lg font-semibold text-sm transition duration-150" 
                    data-category="Lifestyle Behaviors">Lifestyle Behaviors</button>
            <button class="tab-button py-2 px-4 rounded-t-lg font-semibold text-sm transition duration-150" 
                    data-category="Psychosocial Factors">Psychosocial Factors</button>
        </div>

        <!-- Content Area -->
        <div id="content-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Factor Cards will be dynamically inserted here -->
        </div>

        <div class="mt-10 p-4 bg-white rounded-lg shadow-md text-sm text-gray-600">
            <h3 class="font-bold text-gray-800 mb-2">Interpretation Key:</h3>
            <p><span class="inline-block w-3 h-3 risk mr-2"></span> **Risk Factor (Red):** Statistically significant increase in odds (aOR > 1.0, 95% CI is entirely above 1.0).</p>
            <p><span class="inline-block w-3 h-3 protective mr-2"></span> **Protective Factor (Green):** Statistically significant decrease in odds (aOR < 1.0, 95% CI is entirely below 1.0).</p>
            <p><span class="inline-block w-3 h-3 insignificant mr-2"></span> **Non-Significant (Blue):** No statistical association (95% CI crosses 1.0 or p > 0.05).</p>
        </div>
    </div>

    <script>
        const allFactors = {
            "Socio-Demographic": [
                { factor: "Male Sex (vs Female)", outcomes: [
                    { name: "Anxiety", aOR: 0.47, lower: 0.35, upper: 0.63, p: "< 0.001" },
                    { name: "Depression", aOR: 0.61, lower: 0.45, upper: 0.82, p: "0.001" }
                ]},
                { factor: "2nd Year Student (vs 1st Year)", outcomes: [
                    { name: "Anxiety", aOR: 1.00, lower: 0.70, upper: 1.40, p: "N.S." }, 
                    { name: "Depression", aOR: 1.41, lower: 1.08, upper: 1.98, p: "0.013" }
                ]},
                { factor: "Hostel Residence (vs Family)", outcomes: [
                    { name: "Anxiety", aOR: 1.00, lower: 0.75, upper: 1.35, p: "N.S." }, 
                    { name: "Depression", aOR: 1.00, lower: 0.75, upper: 1.35, p: "N.S." }
                ]},
            ],
            "Lifestyle Behaviors": [
                { factor: "Sedentary (vs Highly Active)", outcomes: [
                    { name: "Anxiety", aOR: 1.51, lower: 1.00, upper: 2.29, p: "0.049" },
                    { name: "Depression", aOR: 1.55, lower: 1.05, upper: 2.29, p: "0.029" }
                ]},
                { factor: "Regular Sleep (vs Irregular)", outcomes: [
                    { name: "Anxiety", aOR: 0.51, lower: 0.36, upper: 0.72, p: "< 0.001" },
                    { name: "Depression", aOR: 0.44, lower: 0.31, upper: 0.61, p: "< 0.001" }
                ]},
                { factor: "Low Screen Time <2h (vs High ≥5h)", outcomes: [
                    { name: "Anxiety", aOR: 0.56, lower: 0.36, upper: 0.89, p: "0.01" },
                    { name: "Depression", aOR: 0.43, lower: 0.27, upper: 0.69, p: "< 0.001" }
                ]},
            ],
            "Psychosocial Factors": [
                { factor: "Negative Coping (vs Positive)", outcomes: [
                    { name: "Anxiety", aOR: 1.88, lower: 1.43, upper: 2.47, p: "< 0.001" },
                    { name: "Depression", aOR: 2.05, lower: 1.56, upper: 2.69, p: "< 0.001" }
                ]},
                { factor: "Weak Family Support (vs Strong)", outcomes: [
                    { name: "Anxiety", aOR: 1.62, lower: 1.22, upper: 2.17, p: "0.001" },
                    { name: "Depression", aOR: 2.03, lower: 1.52, upper: 2.70, p: "< 0.001" }
                ]},
                { factor: "Weak Social Support (vs Strong)", outcomes: [
                    { name: "Anxiety", aOR: 1.58, lower: 1.20, upper: 2.09, p: "0.001" },
                    { name: "Depression", aOR: 1.83, lower: 1.38, upper: 2.42, p: "< 0.001" }
                ]},
                { factor: "No Peer Pressure (vs Yes)", outcomes: [
                    { name: "Anxiety", aOR: 0.36, lower: 0.27, upper: 0.49, p: "< 0.001" },
                    { name: "Depression", aOR: 0.29, lower: 0.21, upper: 0.40, p: "< 0.001" }
                ]},
            ]
        };

        const container = document.getElementById('content-container');
        const tabButtons = document.querySelectorAll('.tab-button');
        
        // Helper function to determine the risk classification
        function getRiskClass(outcome) {
            // Check for statistical significance (p-value check is implicit in CI check for this dataset)
            const significant = outcome.lower > 1.0 || outcome.upper < 1.0;

            if (outcome.lower > 1.0) {
                return { class: 'risk', icon: '🚨', label: 'RISK FACTOR' };
            } else if (outcome.upper < 1.0) {
                return { class: 'protective', icon: '✅', label: 'PROTECTIVE FACTOR' };
            } else {
                return { class: 'insignificant', icon: '❓', label: 'NON-SIGNIFICANT' };
            }
        }

        function createFactorCard(factorData) {
            // Determine the *most severe* classification for the overall card color
            let riskStatus = 'insignificant';
            let icon = '❓';
            let label = 'NON-SIGNIFICANT';

            // Iterate to find the most visually impactful classification (Risk > Protective > Insignificant)
            for (const outcome of factorData.outcomes) {
                const status = getRiskClass(outcome);
                if (status.class === 'risk') {
                    riskStatus = status.class;
                    icon = '🚨';
                    label = 'RISK FACTOR';
                    break; // Risk trumps all, so we stop here
                } else if (status.class === 'protective' && riskStatus !== 'risk') {
                    riskStatus = status.class;
                    icon = '✅';
                    label = 'PROTECTIVE FACTOR';
                }
            }
            
            // Build the back of the card (detailed statistics)
            const backContent = factorData.outcomes.map(outcome => {
                const status = getRiskClass(outcome);
                return `
                    <div class="mb-2 p-2 rounded-lg ${status.class === 'risk' ? 'bg-red-50' : status.class === 'protective' ? 'bg-green-50' : 'bg-blue-50'}">
                        <p class="text-sm font-semibold">${outcome.name}: ${status.label}</p>
                        <p class="text-xs">aOR: ${outcome.aOR.toFixed(2)} (95% CI: ${outcome.lower.toFixed(2)}-${outcome.upper.toFixed(2)})</p>
                        <p class="text-xs">P-value: ${outcome.p}</p>
                    </div>
                `;
            }).join('');

            // HTML Structure for the card (using the flip functionality)
            const cardHTML = `
                <div class="card-container" onclick="this.classList.toggle('flipped')">
                    <div class="flip-card flip-card-inner">
                        <!-- Card Front -->
                        <div class="card-face card-front ${riskStatus}">
                            <div class="icon">${icon}</div>
                            <h3 class="text-lg font-bold mt-2">${factorData.factor}</h3>
                            <p class="text-xs font-semibold mt-1">${label}</p>
                            <p class="text-xs mt-2 text-gray-700">(Click for Details)</p>
                        </div>
                        
                        <!-- Card Back -->
                        <div class="card-face card-back">
                            <h3 class="text-base font-bold mb-2 text-gray-800">${factorData.factor}</h3>
                            ${backContent}
                            <p class="text-xs mt-2 text-gray-500">(Click to Flip Back)</p>
                        </div>
                    </div>
                </div>
            `;
            return cardHTML;
        }

        function renderCategory(categoryName) {
            container.innerHTML = '';
            const data = allFactors[categoryName];
            if (data) {
                data.forEach(factor => {
                    const card = createFactorCard(factor);
                    const wrapper = document.createElement('div');
                    wrapper.innerHTML = card;
                    container.appendChild(wrapper.firstElementChild);
                });
            }
        }

        function handleTabClick(event) {
            const category = event.target.dataset.category;
            
            // Update active tab styling
            tabButtons.forEach(btn => {
                btn.classList.remove('active-tab', 'border-blue-500', 'text-blue-600', 'bg-white');
                btn.classList.add('text-gray-600', 'hover:bg-gray-100');
            });
            event.target.classList.add('active-tab', 'border-blue-500', 'text-blue-600', 'bg-white');
            event.target.classList.remove('text-gray-600', 'hover:bg-gray-100');

            renderCategory(category);
        }

        // Initialize listeners and set default view
        tabButtons.forEach(button => {
            button.addEventListener('click', handleTabClick);
        });

        // Set default tab styling and content on load
        document.querySelector('.tab-button').classList.add('border-blue-500', 'text-blue-600', 'bg-white');
        renderCategory("Socio-Demographic");
    </script>
</body>
</html>
